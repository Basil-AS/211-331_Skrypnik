# Лабораторная работа 1: Менеджер паролей с защитой

## Описание
Менеджер паролей с реализацией следующих механизмов защиты:
1. Защита от кражи учетных данных из файловой системы
2. Защита от кражи учетных данных из виртуальной памяти
3. Защита от отладки на пользовательском уровне
4. Защита от модификации исполняемого модуля приложения

## Требования
- Windows 10/11
- Qt 6.8.x
- CMake 3.16+
- Ninja или другой генератор сборки
- Python 3.8+ с библиотекой cryptography для генерации тестовых данных
- Visual Studio 2022 (компилятор MSVC)

## Установка необходимых Python библиотек
```
pip install cryptography
```

## Компиляция проекта в Qt Creator

1. **Откройте основной проект в Qt Creator**:
   - Выберите `File` -> `Open File or Project...`
   - Выберите файл `CMakeLists.txt` в корне проекта
   - Нажмите `Configure Project`

2. **Соберите проект**:
   - Выберите конфигурацию сборки (Debug или Release) в левом нижнем углу
   - Нажмите `Build` (Ctrl+B)
   - Будет собрано как основное приложение, так и программа-протектор

3. **После сборки** в директории сборки будут доступны файлы:
   - `LR1.exe` - основное приложение
   - `PasswordManagerProtector.exe` - программа-протектор

## Запуск приложения

### Вариант 1: С использованием скрипта

```powershell
./run_project.ps1
```

### Вариант 2: Ручной запуск 

1. Перейдите в директорию сборки:
   ```powershell
   cd build\Desktop_Qt_6_8_3_MSVC2022_64bit-Debug
   ```
   (или `build\Desktop_Qt_6_8_3_MSVC2022_64bit-Release` для релизной версии)

2. **Для запуска с защитой от отладки**:
   ```powershell
   .\PasswordManagerProtector.exe
   ```

3. **Для запуска без защиты от отладки** (только для разработки):
   ```powershell
   .\LR1.exe
   ```

## Вход в приложение

- **PIN-код для входа** по умолчанию: **1234**

## Сборка проекта
### Вариант 1: PowerShell
1. Откройте PowerShell в директории проекта
2. Запустите скрипт сборки
```powershell
.\build_project.ps1
```

### Вариант 2: Командная строка (CMD)
1. Откройте командную строку в директории проекта
2. Запустите скрипт сборки
```
build_project.bat
```

### Вариант 3: Ручная сборка в Qt Creator
1. Откройте CMakeLists.txt в Qt Creator
2. Настройте проект и выполните сборку
3. Скопируйте библиотеки OpenSSL в директорию с исполняемым файлом:
   - libcrypto-3-x64.dll
   - libssl-3-x64.dll
4. Запустите windeployqt.exe для копирования библиотек Qt:
```
C:\Qt\6.8.3\msvc2022_64\bin\windeployqt.exe LR1.exe
```

## Запуск приложения

### Обычный запуск (без защиты от отладки других процессов)
Запустите `LR1.exe` из директории сборки.

### Запуск с полной защитой
Запустите `PasswordManagerProtector.exe` из директории сборки. Этот протектор запустит менеджер паролей и защитит его от отладки другими процессами.

## Тестовые учетные данные
Для демонстрационных целей используется фиксированный пин-код: `1234`

## Структура проекта
- **main.cpp** - точка входа, проверки безопасности
- **mainwindow.h/cpp** - главное окно приложения
- **authwindow.h/cpp** - окно аутентификации  
- **credentialsmodel.h/cpp** - модель данных учетных записей
- **PasswordManagerProtector/PasswordManagerProtector.cpp** - протектор от отладки
- **generate_vault.py** - генератор зашифрованного файла данных

## Реализованные механизмы защиты
1. **Защита от кражи учетных данных из файла**
   - Шифрование файла с учетными данными алгоритмом AES-256
   - Ключ шифрования генерируется на основе пин-кода

2. **Защита от кражи учетных данных из виртуальной памяти**
   - Логины и пароли хранятся в памяти в зашифрованном виде
   - Расшифровываются только при явном запросе пользователя

3. **Защита от отладки**
   - Использование API Windows IsDebuggerPresent()
   - Самоотладка для защиты от внешних отладчиков

4. **Защита от модификации исполняемого модуля**
   - Проверка контрольной суммы сегмента .text
   - Блокировка при обнаружении модификации
